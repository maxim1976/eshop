{% load static %}
{# Hero Carousel Component with Meat Product Images - 3 slides (Mingchang first) #}
<div id="hero-carousel" class="relative w-full overflow-hidden bg-gray-900">
  <!-- Slides wrapper -->
  <div class="carousel-track relative flex transition-transform duration-700 ease-in-out" data-active-index="0">
    
    {# Slide 1: Mingchang Specialty (now first) #}
    <section class="slide w-full flex-shrink-0 h-[420px] md:h-[520px] lg:h-[600px] relative overflow-hidden">
      <!-- Background Image -->
      <div class="absolute inset-0 z-0">
        <img src="{{ MEDIA_URL }}pictures/mingchang.jpg" 
             alt="名昌特選肉品" 
             class="w-full h-full object-cover"
             loading="eager">
        <div class="absolute inset-0 bg-black bg-opacity-50"></div>
      </div>
      <!-- Content Overlay -->
      <div class="relative z-10 flex items-center justify-center h-full text-white text-center px-6">
        <div class="max-w-4xl mx-auto">
          <div class="mb-4 flex justify-center">
            {% include 'components/logo.html' with size='medium' link=False %}
          </div>
          <h1 class="text-4xl md:text-6xl font-bold mb-4 drop-shadow-lg">名昌特選肉品</h1>
          <p class="text-xl md:text-2xl mb-8 text-red-100 drop-shadow">嚴選優質肉品，新鮮配送，品質保證</p>
          <div class="flex justify-center gap-4">
            <a href="{% url 'products:product_list' %}" class="bg-red-600 hover:bg-red-700 text-white px-8 py-3 rounded-lg font-semibold text-lg transition-colors duration-200 shadow-lg">立即選購</a>
            <a href="{% url 'products:product_list' %}?featured=true" class="bg-white text-red-600 px-8 py-3 rounded-lg font-semibold hover:bg-red-50 transition-colors duration-200 shadow-lg">精選商品</a>
          </div>
        </div>
      </div>
    </section>
    
    {# Slide 2: Angus Beef (now second) #}
    <section class="slide w-full flex-shrink-0 h-[420px] md:h-[520px] lg:h-[600px] relative overflow-hidden">
      <!-- Background Image -->
      <div class="absolute inset-0 z-0">
        <img src="{{ MEDIA_URL }}pictures/angus.jpg" 
             alt="優質安格斯牛肉" 
             class="w-full h-full object-cover"
             loading="lazy">
        <div class="absolute inset-0 bg-black bg-opacity-50"></div>
      </div>
      <!-- Content Overlay -->
      <div class="relative z-10 flex items-center justify-center h-full text-white text-center px-6">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-4xl md:text-6xl font-bold mb-4 drop-shadow-lg">優質安格斯牛肉</h2>
          <p class="text-xl md:text-2xl mb-8 text-red-100 drop-shadow">精選頂級安格斯牛肉，肉質鮮美，口感絕佳</p>
          <div class="flex justify-center gap-4">
            <a href="{% url 'products:product_list' %}?category=beef" class="bg-red-600 hover:bg-red-700 text-white px-8 py-3 rounded-lg font-semibold text-lg transition-colors duration-200 shadow-lg">選購牛肉</a>
            <a href="{% url 'products:category_list' %}" class="bg-white text-red-600 px-8 py-3 rounded-lg font-semibold hover:bg-red-50 transition-colors duration-200 shadow-lg">瀏覽分類</a>
          </div>
        </div>
      </div>
    </section>
    
    {# Slide 3: Kurubota Pork (now third) #}
    <section class="slide w-full flex-shrink-0 h-[420px] md:h-[520px] lg:h-[600px] relative overflow-hidden">
      <!-- Background Image -->
      <div class="absolute inset-0 z-0">
        <img src="{{ MEDIA_URL }}pictures/kurubota.jpg" 
             alt="日本黑豚肉" 
             class="w-full h-full object-cover"
             loading="lazy">
        <div class="absolute inset-0 bg-black bg-opacity-50"></div>
      </div>
      <!-- Content Overlay -->
      <div class="relative z-10 flex items-center justify-center h-full text-white text-center px-6">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-4xl md:text-6xl font-bold mb-4 drop-shadow-lg">日本黑豚肉</h2>
          <p class="text-xl md:text-2xl mb-8 text-red-100 drop-shadow">來自日本的頂級黑豚肉，肉質細緻，脂肪分布均勻</p>
          <div class="flex justify-center gap-4">
            <a href="{% url 'products:product_list' %}?category=pork" class="bg-red-600 hover:bg-red-700 text-white px-8 py-3 rounded-lg font-semibold text-lg transition-colors duration-200 shadow-lg">選購豬肉</a>
            <a href="{% url 'auth:register-form' %}" class="bg-white text-red-600 px-8 py-3 rounded-lg font-semibold hover:bg-red-50 transition-colors duration-200 shadow-lg">會員專享</a>
          </div>
        </div>
      </div>
    </section>
    
  
  {# Indicators #}
  <div class="absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2 z-20">
    <button class="carousel-indicator w-3 h-3 rounded-full bg-white/60 ring-2 ring-white/80 focus:outline-none hover:bg-white/80 transition-all duration-200" data-index="0" aria-label="名昌特選肉品"></button>
    <button class="carousel-indicator w-3 h-3 rounded-full bg-white/40 ring-2 ring-white/80 focus:outline-none hover:bg-white/80 transition-all duration-200" data-index="1" aria-label="安格斯牛肉"></button>
    <button class="carousel-indicator w-3 h-3 rounded-full bg-white/40 ring-2 ring-white/80 focus:outline-none hover:bg-white/80 transition-all duration-200" data-index="2" aria-label="黑豚肉"></button>
  </div>
  
  {# Prev/Next Controls #}
  <button type="button" class="carousel-prev absolute inset-y-0 left-4 flex items-center justify-center bg-black bg-opacity-30 hover:bg-opacity-50 rounded-full w-12 h-12 text-white/80 hover:text-white transition-all duration-200 z-20" aria-label="上一張">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
  </button>
  <button type="button" class="carousel-next absolute inset-y-0 right-4 flex items-center justify-center bg-black bg-opacity-30 hover:bg-opacity-50 rounded-full w-12 h-12 text-white/80 hover:text-white transition-all duration-200 z-20" aria-label="下一張">
    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
  </button>
</div>
<script>
(function(){
  const root = document.getElementById('hero-carousel');
  if(!root) return;
  const track = root.querySelector('.carousel-track');
  const slides = Array.from(root.querySelectorAll('.slide'));
  const indicators = Array.from(root.querySelectorAll('.carousel-indicator'));
  const prevBtn = root.querySelector('.carousel-prev');
  const nextBtn = root.querySelector('.carousel-next');
  let index = 0;
  let autoplayTimer = null;
  const slideCount = slides.length;
  function update(){
    track.style.transform = `translateX(-${index * 100}%)`;
    indicators.forEach((dot,i)=>{
      dot.classList.toggle('bg-white', i===index);
      dot.classList.toggle('bg-white/40', i!==index);
    });
    root.setAttribute('data-active-index', index);
  }
  function go(to){
    index = (to + slideCount) % slideCount;
    update();
  }
  function next(){ go(index+1); }
  function prev(){ go(index-1); }
  indicators.forEach(dot => dot.addEventListener('click', () => { go(parseInt(dot.dataset.index)); restartAutoplay(); }));
  prevBtn.addEventListener('click', () => { prev(); restartAutoplay(); });
  nextBtn.addEventListener('click', () => { next(); restartAutoplay(); });
  function startAutoplay(){
    autoplayTimer = setInterval(()=>{ next(); }, 6000);
  }
  function restartAutoplay(){
    if(autoplayTimer){ clearInterval(autoplayTimer); }
    startAutoplay();
  }
  startAutoplay();
  update();
  // Pause autoplay on hover for accessibility
  root.addEventListener('mouseenter', ()=>{ if(autoplayTimer) clearInterval(autoplayTimer); });
  root.addEventListener('mouseleave', ()=>{ restartAutoplay(); });
  // Keyboard navigation
  root.addEventListener('keydown', (e)=>{
    if(e.key === 'ArrowLeft'){ prev(); restartAutoplay(); }
    if(e.key === 'ArrowRight'){ next(); restartAutoplay(); }
  });
})();
</script>
